<!DOCTYPE html>
<html>
<head>
    <title>ü§ñ AI GitHub Admin</title>
    <style>
        body { background: #0d1117; color: white; font-family: sans-serif; padding: 20px; }
        .container { max-width: 800px; margin: auto; }
        .card { background: #161b22; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        textarea, input { width: 100%; padding: 10px; margin: 10px 0; background: #0d1117; color: white; border: 1px solid #30363d; }
        button { background: #238636; color: white; border: none; padding: 10px 20px; cursor: pointer; margin: 5px; }
        .flex { display: flex; gap: 10px; flex-wrap: wrap; }
        .error { color: #ff7b72; background: #3d1f1f; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h2>ü§ñ AI GitHub Admin</h2>
            <input type="password" id="ghToken" placeholder="GitHub —Ç–æ–∫–µ–Ω" value="">
            <input type="password" id="orToken" placeholder="OpenRouter –∫–ª—é—á" value="">
            <button onclick="saveTokens()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω—ã</button>
        </div>

        <div class="card">
            <div class="flex">
                <button onclick="listFiles()">üìã –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤</button>
                <button onclick="deploySite()">üöÄ –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å —Å–∞–π—Ç</button>
            </div>
            <div id="fileList"></div>
        </div>

        <div class="card">
            <h3>ü§ñ AI –ö–æ–º–∞–Ω–¥—ã</h3>
            <textarea id="aiInput" rows="3" placeholder="–ù–∞–ø–∏—à–∏ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å..."></textarea>
            <button onclick="aiCommand()">üöÄ –í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
            <div id="aiResponse"></div>
        </div>
    </div>

    <script>
        const REPO = 'artemis1987/Privet-mir';
        
        function saveTokens() {
            localStorage.setItem('gh_token', document.getElementById('ghToken').value);
            localStorage.setItem('or_token', document.getElementById('orToken').value);
            alert('‚úÖ –¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
        }

        function getToken() {
            return localStorage.getItem('gh_token') || document.getElementById('ghToken').value;
        }

        function getOR() {
            return localStorage.getItem('or_token') || document.getElementById('orToken').value;
        }

        async function aiCommand() {
            const text = document.getElementById('aiInput').value;
            if (!text) return;
            
            const orKey = getOR();
            if (!orKey) { alert('–í–≤–µ–¥–∏ OpenRouter –∫–ª—é—á'); return; }
            
            document.getElementById('aiResponse').innerHTML = '‚è≥ –î—É–º–∞—é...';
            
            try {
                const res = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${orKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'openai/gpt-3.5-turbo',
                        messages: [{ role: 'user', content: text }]
                    })
                });
                
                const data = await res.json();
                
                // –ü–†–û–í–ï–†–Ø–ï–ú —á—Ç–æ –æ—Ç–≤–µ—Ç –µ—Å—Ç—å
                if (data.choices && data.choices[0]) {
                    const answer = data.choices[0].message.content;
                    document.getElementById('aiResponse').innerHTML = `<div style="background:#21262d; padding:10px;">ü§ñ ${answer}</div>`;
                    
                    // AI —Å–∞–º —Å–æ–∑–¥–∞—Å—Ç —Å–∞–π—Ç –µ—Å–ª–∏ –ø–æ–ø—Ä–æ—Å–∏–ª–∏
                    if (text.includes('—Å–∞–π—Ç') && text.includes('–∫–ª–∏–Ω–∏–Ω–≥')) {
                        createWebsite();
                    }
                } else {
                    document.getElementById('aiResponse').innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞ –æ—Ç–≤–µ—Ç–∞: ${JSON.stringify(data)}</div>`;
                }
                
            } catch (e) {
                document.getElementById('aiResponse').innerHTML = `<div class="error">‚ùå ${e.message}</div>`;
            }
        }

        // –°–û–ó–î–ê–ï–ú –°–ê–ô–¢ –î–õ–Ø –ö–õ–ò–ù–ò–ù–ì–ê
        async function createWebsite() {
            const token = getToken();
            if (!token) { alert('–ù–µ—Ç GitHub —Ç–æ–∫–µ–Ω–∞'); return; }
            
            const html = `<!DOCTYPE html>
<html>
<head>
    <title>–ö–ª–∏–Ω–∏–Ω–≥ –£—Ñ–∞</title>
    <style>
        body { font-family: Arial; margin: 0; padding: 20px; background: #f5f5f5; }
        .header { background: #2196f3; color: white; padding: 20px; text-align: center; }
        .services { display: grid; grid-template-columns: repeat(3,1fr); gap: 20px; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .price { color: #2196f3; font-size: 24px; font-weight: bold; }
        button { background: #2196f3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        footer { background: #333; color: white; text-align: center; padding: 20px; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>–ö–ª–∏–Ω–∏–Ω–≥ –£—Ñ–∞</h1>
        <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞ –≤ –£—Ñ–µ</p>
    </div>
    
    <div class="services">
        <div class="card">
            <h3>–£–±–æ—Ä–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä</h3>
            <p>–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞</p>
            <div class="price">3000 ‚ÇΩ</div>
            <button>–ó–∞–∫–∞–∑–∞—Ç—å</button>
        </div>
        <div class="card">
            <h3>–£–±–æ—Ä–∫–∞ –æ—Ñ–∏—Å–æ–≤</h3>
            <p>–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</p>
            <div class="price">5000 ‚ÇΩ</div>
            <button>–ó–∞–∫–∞–∑–∞—Ç—å</button>
        </div>
        <div class="card">
            <h3>–ú–æ–π–∫–∞ –æ–∫–æ–Ω</h3>
            <p>–û—Ç–º—ã–≤–∞–µ–º –¥–æ –±–ª–µ—Å–∫–∞</p>
            <div class="price">2000 ‚ÇΩ</div>
            <button>–ó–∞–∫–∞–∑–∞—Ç—å</button>
        </div>
    </div>
    
    <footer>
        <p>–ö–ª–∏–Ω–∏–Ω–≥ –£—Ñ–∞ | –¢–µ–ª–µ—Ñ–æ–Ω: +7 (999) 123-45-67</p>
    </footer>
</body>
</html>`;
            
            // –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª index.html
            const check = await fetch(`https://api.github.com/repos/${REPO}/contents/index.html`, {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            
            let sha = null;
            if (check.ok) {
                const data = await check.json();
                sha = data.sha;
            }
            
            const res = await fetch(`https://api.github.com/repos/${REPO}/contents/index.html`, {
                method: 'PUT',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    message: '–°–æ–∑–¥–∞–Ω —Å–∞–π—Ç –∫–ª–∏–Ω–∏–Ω–≥–∞',
                    content: btoa(unescape(encodeURIComponent(html))),
                    branch: 'main',
                    sha: sha
                })
            });
            
            if (res.ok) {
                document.getElementById('aiResponse').innerHTML += '<br>‚úÖ –°–∞–π—Ç —Å–æ–∑–¥–∞–Ω!';
                deploySite();
            }
        }

        async function deploySite() {
            const token = getToken();
            await fetch(`https://api.github.com/repos/${REPO}/pages/builds`, {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${token}` }
            });
            alert('üöÄ –°–∞–π—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É –Ω–∞ https://artemis1987.github.io/Privet-mir/');
        }

        async function listFiles() {
            const token = getToken();
            if (!token) { alert('–ù–µ—Ç —Ç–æ–∫–µ–Ω–∞'); return; }
            
            const res = await fetch(`https://api.github.com/repos/${REPO}/git/trees/main?recursive=1`, {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            
            const data = await res.json();
            let html = '<div style="margin-top:10px;">';
            data.tree?.forEach(item => {
                if (item.type === 'blob') {
                    html += `<div style="padding:5px; background:#0d1117; margin:2px;">üìÑ ${item.path}</div>`;
                }
            });
            html += '</div>';
            document.getElementById('fileList').innerHTML = html;
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–∫–µ–Ω—ã
        document.getElementById('ghToken').value = localStorage.getItem('gh_token') || '';
        document.getElementById('orToken').value = localStorage.getItem('or_token') || '';
    </script>
</body>
</html>
